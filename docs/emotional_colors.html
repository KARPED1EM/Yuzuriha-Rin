<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Emotion Palette Preview (HSL × Intensity)</title>
  <style>
    :root{
      --bg:#dcdcdc;        /* final background board */
      --ink:#141414;
      --muted:#3b3b3b;
      --border:rgba(0,0,0,.10);
      --card: rgba(255,255,255,.62);
      --card2: rgba(255,255,255,.78);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color:var(--ink);
    }
    header{
      padding:26px 18px 10px;
      max-width:1200px;
      margin:0 auto;
    }
    h1{font-size:18px;margin:0 0 8px;letter-spacing:.2px}
    p{margin:0;color:var(--muted);font-size:13px;line-height:1.55}

    .controls{
      max-width:1200px;margin:0 auto;padding:0 18px 12px;
      display:flex;gap:10px;align-items:center;flex-wrap:wrap;
    }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.55);
      color: var(--ink);
      padding:8px 10px;border-radius:12px;
      font-size:12px;cursor:pointer;
    }
    .btn:hover{background: rgba(255,255,255,.75);}

    .tableWrap{
      max-width:1200px;margin:0 auto;padding:0 18px 28px;
    }

    .legend{
      display:grid;
      grid-template-columns: 240px repeat(4, minmax(190px, 1fr));
      gap:12px;
      margin-bottom:8px;
      align-items:end;
    }
    .legend .head{
      font-size:12px;
      padding:0 10px;
      color: rgba(0,0,0,.86);
    }
    .legend .sub{
      color: rgba(0,0,0,.55);
      font-size:11px;
      margin-top:4px;
      line-height:1.35;
    }

    .row{
      display:grid;
      grid-template-columns: 240px repeat(4, minmax(190px, 1fr));
      gap:12px;
      padding:12px 0;
      border-top:1px solid rgba(0,0,0,.08);
    }

    .nameCard, .cell{
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      background: var(--card);
      box-shadow: 0 10px 24px rgba(0,0,0,.08);
      display:flex;
      gap:10px;
      align-items:center;
      min-width:0;
    }
    .nameCard{background: var(--card2);}

    .dot{
      width:14px;height:14px;border-radius:999px;
      border:1px solid rgba(0,0,0,.16);
      flex:0 0 auto;
      background:#999;
    }
    .swatch{
      width:46px;height:46px;border-radius:14px;
      border:1px solid rgba(0,0,0,.12);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.06);
      flex:0 0 auto;
      background:#bbb;
    }

    .meta{min-width:0}
    .title{
      font-weight:700;
      font-size:13px;
      margin:0 0 4px;
      text-transform: none;
    }
    .base{
      font-size:11px;
      color: rgba(0,0,0,.58);
      line-height:1.35;
    }

    code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      color: rgba(0,0,0,.86);
      background: rgba(255,255,255,.65);
      border:1px solid rgba(0,0,0,.10);
      padding:3px 6px;
      border-radius:8px;
      display:inline-block;
      margin:0 6px 6px 0;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      vertical-align:top;
    }
    .hint{font-size:11px;color: rgba(0,0,0,.55);margin-top:2px}

    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background: rgba(255,255,255,.92);
      border:1px solid rgba(0,0,0,.12);
      color: rgba(0,0,0,.88);
      padding:10px 14px;
      border-radius:999px;
      font-size:12px;
      opacity:0;pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-2px);}
  </style>
</head>

<body>
  <header>
    <h1>Emotion Palette Preview (HSL × Intensity)</h1>
    <p>
      Rule: <b>L += dl</b>, <b>S += ds</b> (clamped to 0–100), and <b>alpha</b> is applied as
      <code>hsl(h s% l% / a)</code>. Click any <code>HSLA</code> or <code>HEX</code> to copy.
    </p>
  </header>

  <div class="controls">
    <button class="btn" id="copyAllHsLa">Copy all HSLA (JSON)</button>
    <button class="btn" id="copyAllHex">Copy all HEX (JSON, alpha ignored)</button>
  </div>

  <div class="tableWrap">
    <div class="legend" id="legend"></div>
    <div id="rows"></div>
  </div>

  <div class="toast" id="toast">Copied</div>

  <script>
    /** @type {Record<string, {h:number,s:number,l:number}>} */
    const palette = {
      neutral: { h: 0, s: 0, l: 70 }, // ignored
      // Warm
      angry: { h: 4, s: 90, l: 50 }, // deep red
      excited: { h: 22, s: 95, l: 54 }, // vivid orange
      happy: { h: 52, s: 95, l: 58 }, // bright yellow
      // Green / teal
      caring: { h: 145, s: 70, l: 48 }, // green
      playful: { h: 95, s: 85, l: 52 }, // lime-green
      confused: { h: 182, s: 72, l: 46 }, // teal
      surprised: { h: 198, s: 88, l: 56 }, // cyan
      // Blue
      sad: { h: 220, s: 78, l: 54 }, // blue
      serious: { h: 235, s: 58, l: 44 }, // deep navy-blue
      // Purple / pink
      anxious: { h: 275, s: 70, l: 52 }, // purple
      shy: { h: 305, s: 62, l: 60 }, // violet-pink
      embarrassed: { h: 332, s: 86, l: 58 }, // magenta
      affectionate: { h: 350, s: 90, l: 58 }, // rose
      // Low-saturation states
      tired: { h: 210, s: 22, l: 60 }, // desaturated blue-gray
      bored: { h: 40, s: 18, l: 62 }, // warm gray
    };

    /** @type {Record<string, {alpha:number, dl:number, ds:number}>} */
    const intensity = {
      low: { alpha: 0.28, dl: 14, ds: -14 },
      medium: { alpha: 0.5, dl: 7, ds: -6 },
      high: { alpha: 0.74, dl: 0, ds: 0 },
      extreme: { alpha: 0.92, dl: -8, ds: 6 },
    };

    const levels = Object.keys(intensity);
    const toast = document.getElementById('toast');
    const rowsEl = document.getElementById('rows');
    const legendEl = document.getElementById('legend');

    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function applyIntensity(base, rule){
      return {
        h: base.h,
        s: clamp(base.s + rule.ds, 0, 100),
        l: clamp(base.l + rule.dl, 0, 100),
        a: clamp(rule.alpha, 0, 1),
      };
    }

    function hslaString({h,s,l,a}) { return `hsl(${h} ${s}% ${l}% / ${a})`; }
    function hslString({h,s,l}) { return `hsl(${h} ${s}% ${l}%)`; }

    // HSL -> RGB -> HEX (alpha is not representable in HEX here)
    function hslToRgb(h, s, l){
      s /= 100; l /= 100;
      const k = n => (n + h / 30) % 12;
      const a = s * Math.min(l, 1 - l);
      const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
      return [Math.round(255 * f(0)), Math.round(255 * f(8)), Math.round(255 * f(4))];
    }
    function rgbToHex(r,g,b){
      const toHex = x => x.toString(16).padStart(2,'0');
      return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
    }
    function hslToHex({h,s,l}){
      const [r,g,b] = hslToRgb(h,s,l);
      return rgbToHex(r,g,b);
    }

    async function copy(text){
      try{
        await navigator.clipboard.writeText(text);
        toast.textContent = `Copied: ${text.length > 80 ? text.slice(0,80)+'…' : text}`;
      }catch{
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        toast.textContent = `Copied`;
      }
      toast.classList.add('show');
      clearTimeout(copy._t);
      copy._t = setTimeout(()=>toast.classList.remove('show'), 1100);
    }

    // legend header
    const left = document.createElement('div');
    left.className = 'head';
    left.textContent = 'Emotion';
    legendEl.appendChild(left);

    levels.forEach(lv => {
      const {alpha, dl, ds} = intensity[lv];
      const h = document.createElement('div');
      h.className = 'head';
      h.innerHTML = `<div><b>${lv}</b></div><div class="sub">alpha ${alpha} · dl ${dl} · ds ${ds}</div>`;
      legendEl.appendChild(h);
    });

    function makeNameCard(name, base){
      const card = document.createElement('div');
      card.className = 'nameCard';

      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.style.background = hslString(base);

      const meta = document.createElement('div');
      meta.className = 'meta';

      const title = document.createElement('div');
      title.className = 'title';
      title.textContent = name;

      const baseHsl = `hsl(${base.h} ${base.s}% ${base.l}%)`;
      const baseHex = hslToHex(base);

      const baseLine = document.createElement('div');
      baseLine.className = 'base';
      baseLine.textContent = `base: ${baseHsl} · ${baseHex}`;

      meta.appendChild(title);
      meta.appendChild(baseLine);

      card.appendChild(dot);
      card.appendChild(meta);
      return card;
    }

    function makeCell(base, levelKey){
      const rule = intensity[levelKey];
      const v = applyIntensity(base, rule);

      const cell = document.createElement('div');
      cell.className = 'cell';

      const sw = document.createElement('div');
      sw.className = 'swatch';
      sw.style.background = hslaString(v);

      const meta = document.createElement('div');
      meta.className = 'meta';

      const hsla = hslaString(v);
      const hex = hslToHex(v);

      const c1 = document.createElement('code');
      c1.textContent = hsla;
      c1.title = "Click to copy HSLA";
      c1.onclick = () => copy(hsla);

      const c2 = document.createElement('code');
      c2.textContent = hex;
      c2.title = "Click to copy HEX (alpha ignored)";
      c2.onclick = () => copy(hex);

      const hint = document.createElement('div');
      hint.className = 'hint';
      hint.textContent = 'HEX ignores alpha';

      meta.appendChild(c1);
      meta.appendChild(c2);
      meta.appendChild(hint);

      cell.appendChild(sw);
      cell.appendChild(meta);
      return cell;
    }

    // render rows (keep your insertion order)
    Object.entries(palette).forEach(([name, base]) => {
      const row = document.createElement('div');
      row.className = 'row';

      row.appendChild(makeNameCard(name, base));
      levels.forEach(lv => row.appendChild(makeCell(base, lv)));

      rowsEl.appendChild(row);
    });

    // export buttons
    document.getElementById('copyAllHsLa').onclick = () => {
      const out = {};
      for (const [emo, base] of Object.entries(palette)) {
        out[emo] = {};
        for (const lv of levels) out[emo][lv] = hslaString(applyIntensity(base, intensity[lv]));
      }
      copy(JSON.stringify(out, null, 2));
    };

    document.getElementById('copyAllHex').onclick = () => {
      const out = {};
      for (const [emo, base] of Object.entries(palette)) {
        out[emo] = {};
        for (const lv of levels) out[emo][lv] = hslToHex(applyIntensity(base, intensity[lv]));
      }
      copy(JSON.stringify(out, null, 2));
    };
  </script>
</body>
</html>
